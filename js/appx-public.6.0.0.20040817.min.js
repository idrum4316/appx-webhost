/*********************************************************************
 **
 **   public/js/appx-client-utilities.js - Client helper functions
 **
 **   This module contains some helper functions used by the client
 **
 *********************************************************************/
function initialize_localos_session(){var e={cmd:"localosinit",args:[0,0],handler:"localos_init_handler",data:{languageId:appx_session.language.id},authToken:localStorage.authToken}
localos_session.ws.send(JSON.stringify(e))}function initialize_appx_session(e){var o={cmd:"appxinit",args:[e,0],handler:"appx_init_handler",data:null}
appx_session.ws.send(JSON.stringify(o))}function appendMessage(e){debug&&$("#log").prepend(e+"\n\n")}function initialize_localos_directories(e){var o={cmd:"localoscreatedir",args:[e,0],handler:"localos_init_handler",data:null,authToken:localStorage.authToken}
localos_session.ws.send(JSON.stringify(o))}function inject_image(e){var o=window.URL.createObjectURL(new Blob(e))
img=new Image,img.src=o,$("body").prepend(img)}function inject_image2(e){var o=window.URL.createObjectURL(new Blob([toArrayBuffer(e)]))
img=new Image,img.src=o,$("body").prepend(img)}function inject_script(e){var o=document.createElement("script")
o.type="text/javascript",o.text=e,document.head.appendChild(o)}function inject_style(e){$("head").append($("<style>").attr("type","text/css").text(e)),$("body").change()}function logactivity(e){debug&&console.log(e)}function logca(e){debug&&console.log(++testca+"\t"+e)}function toArrayBuffer(e){for(var o=new ArrayBuffer(e.length),n=new Uint8Array(o),s=0;s<e.length;++s)n[s]=e[s]
return o}function localos_enviro_handler(e){if(logactivity("localos_enviro_handler() called..."),appx_session.setProp("clientPublicVersionStr",appxPublicClientVersionStr),appx_session.setProp("clientPublicVersionNum",appxPublicClientVersionNum),e.localConnectorVersionStr?appx_session.setProp("localConnectorVersionStr",e.localConnectorVersionStr):appx_session.setProp("localConnectorVersionStr","Unknown"),e.localConnectorVersionNum?appx_session.setProp("localConnectorVersionNum",e.localConnectorVersionNum):appx_session.setProp("localConnectorVersionNum",99999.999),appx_session.local_environment=e,appx_session.getProp("localConnectorVersionNum")>=60000.19022101&&!appx_session.local_environment.authTokenValid){var o=Math.floor(1e5+9e5*Math.random())
localos_session.ws.send(JSON.stringify({cmd:"auth",args:[],handler:"",data:{appName:$("meta[name=appx-app-name]").attr("content"),accessCode:o}})),$("#appx-status-msg").html("<span class='status-msg-error'>&nbsp;Local Connector Access Code: "+o+"&nbsp;</span>")}try{setTimeout(function(){if(appx_session.userhome=e[appx_session.globals.os.indexOf("Win")>-1?"USERPROFILE":"HOME"],appx_session.setProp("userHome",appx_session.userhome),$("#localos_access").prop("title",appx_session.language.tooltips.localVersion+appx_session.getProp("localConnectorVersionStr")),appx_session.getProp("localConnectorVersionNum")<appxServerClientVersionNum&&($("#localos_access").html("Local-").css({color:"#FF7","font-weight":"bold"}),appx_session.getProp("localConnectorVersionNum")>50402.009&&null==localos_session.isUpdating)){var o={cmd:"updatelocal",args:[],handler:"appx_updatelocal_handler",data:null}
appx_session.ws.send(JSON.stringify(o))}},1e3)}catch(n){console.log("localos_enviro_handler: can't set home - "+n),console.log(n.stack)}}function appxupdatelocalhandler(e){if(appxIsLocalReady()){var o={}
o.filename="localConnectorUpdate.zip",o.filedata=e,ms={cmd:"update",args:[o],handler:"localos_update_handler",data:null,authToken:localStorage.authToken},$("#localos_access").html("Updating").css({color:"#F77","font-weight":"bold"}),localos_session.isUpdating=!0,localos_session.ws.send(JSON.stringify(ms))}}function parseQueryString(){for(var e={},o=[],n=window.location.href.substring(window.location.href.indexOf("?")+1).split("&"),s=0;s<n.length;s++)o=n[s].split("="),e[decodeURI(o[0])]=decodeURI(o[1])
return e}var appxPublicClientVersionStr="6.0.0.20040817",appxPublicClientVersionNum=60000.20040817,testca=0
/*********************************************************************
 **
 **   public/js/appx-client-local.js - Client Local connection code
 **
 **   This module handles the connection and data traffic between the
 **   Appx Client running in the browser and the appx connector code
 **   running on the desktop.  The local connector is our proxy into
 **   the desktop OS.
 **
 *********************************************************************/
function showLocalMissing(){var a="<h1>Local Desktop Access</h1><p>This application requires local access to your desktop to perform certain functions.  This is a one time activity that does not require any Administrator privileges.</p><p>To allow this access please perform the following steps:<ol><li>Click this link to download the local connector. (<a href='"+appxClientRoot+"/"+appx_session.localInstaller+"'>Download Local Connector</a>)</li><li>Run the downloaded file and follow the prompts.</li><li>Close this popup window to retry local desktop access.</li></p>",e=($("<div id='appx_prefs'>").css({background:"rgba(50, 50, 50, 0.7)",width:"100%",height:"100%","min-height":"220px","z-index":"10000000",display:"none",position:"absolute",top:"0px",left:"0px","font-family":"verdana","font-size":"11px"}).appendTo("body"),$("<div style='border: 10px solid #333;'>").css({width:"550px",height:"220px",background:"#fff"}).appendTo("#appx_prefs").position({my:"center",at:"center",of:window}).draggable()),o=$("<div>").css({margin:"0px 10px",width:"550px",height:"220px"}),s=$("<div>").css({background:"#333","text-align":"right",padding:"5px",color:"#F5F539","font-weight":"bold","padding-bottom":"10px"}).append($("<span>close(X)</span>").click(function(){$("#appx_prefs").hide(),$("#appx_prefs").remove(),localos_session=new LOCALOS}))
$(e).prepend($("<div>").append(s)),$(o).append($("<div>").append(a)),$(o).appendTo(e),$("#appx_prefs").show(),$(a).find("input").change(function(){appx_session.setProp($(this).attr("id"),$(this).val()),null!=appx_session.getRawProp($(this).attr("id"))?$(this).css({background:"#ff0"}):$(this).css({background:"#fff"})})}function LOCALOS(){function a(a){try{var e=new WebSocket("ws://127.0.0.1:3013/")
e.onmessage=function(e){debug&&(logactivity("svr message:  "),logactivity(e.data),appendMessage(e.data+"\n\n")),a.handler(e)},e.onopen=function(a){localos_access=!0,appx_session.localConnectorRunning=!0,$("#localos_access").removeClass().addClass("connected").html("<a href='"+appxClientRoot+"/"+appx_session.localInstaller+"'>Local+</a>"),appendMessage("* Connection to local server(localhost:3013)  open<br/>"),$("#functions").toggleClass("functions_on"),initialize_localos_session()},e.onclose=function(a){localos_access=!1,$("#localos_access").removeClass().addClass("disconnected").html("<a href='"+appxClientRoot+"/"+appx_session.localInstaller+"'>Local</a>"),"true"!=appxLocalRequired||localos_access||localos_session.isUpdating||navigator.userAgent.indexOf("Mobile")!==-1||(showLocalMissing(),appxLocalRequired=!1,appx_session.localConnectorRunning=!1),appendMessage("* Connection to local server(localhost:3013) closed<br/>"),$("#functions").toggleClass("functions_on")},e.onerror=function(a){appendMessage("* Local server(localhost:3013) Error<br/>")}}catch(o){alert(o),console.log(o.stack)}return e}function e(){function a(a){debug&&logactivity("main handler: "+a)
try{var e=JSON.parse(a.data)
switch(logactivity("data:  "+e.data),e.type){case"LOCALOS-RELOAD":setTimeout(function(){localos_session=new LOCALOS,localos_session.isUpdating=!1},500)
break
case"LOCALOS-AUTH":"allow"===e.data.authStatus?(localStorage.authToken=e.data.authToken,$("#appx-status-msg").html("")):$("#appx-status-msg").html("Access Denied")
break
case"LOCALOS-DND":appx_session.dndData=e.data,appxwidgetcallback(OPT_DROP)
break
case"LOCALOS-HTML":$("#appx-frame").append(e.data)
break
case"LOCALOS-STYLE":localos_style_handler(e.data)
break
case"LOCALOS-SCRIPT":inject_script(e.data)
break
case"LOCALOS-OPENFILE":localos_file_handler(e)
break
case"LOCALOS-OPENIMAGE":localos_image_handler(e.data)
break
case"LOCALOS-RUNCOMMAND":localos_cmd_handler(e.data)
break
case"LOCALOS-EXECOMMAND":localos_exec_handler(e.data)
break
case"LOCALOS-ENVIRONMENT":localos_enviro_handler(e.data)
break
case"LOCALOS-SETCLIPBOARD":localos_setclipboard_handler(e.data)
break
case"LOCALOS-GETCLIPBOARD":localos_getclipboard_handler(e.data)
break
case"LOCALOS-FILE-DIALOG":localos_file_dialog_handler(e.data)
break
case"LOCALOS-ERROR":localos_error_handler(e)
break
case"LOCALOS-CREATEFILE":localos_create_file_handler(e.data)
break
case"LOCALOS-APPENDFILE":localos_append_file_handler(e.data)
break
default:logactivity("No handler for LOCAL OS Data Message:  "+a.data)}}catch(o){logactivity(o),console.log("LOCAL Handler: "+o),console.log(o.stack)}}this.handler=a}this.message=new e,this.ws=a(this.message),this.current_msg={header:[]},this.isUpdating=null}function localos_file_dialog_handler(a){var e=$(".awaiting_filepath")
$(e).removeClass("awaiting_filepath"),a&&a.length>0&&a[0].length>0&&($(e).val(a),$(e).addClass("dirty"))}function localos_setclipboard_handler(a){logactivity("localos_setclipboard_handler() called..."),console.log("clipboard data set in localos:  "+a)}function localos_getclipboard_handler(a){logactivity("localos_setclipboard_handler() called..."),console.log("clipboard data got in localos:  "+a)
var e=a,o={cmd:"appxclipboard",args:[e],handler:"appxsendfilehandler",data:null}
appx_session.ws.send(JSON.stringify(o))}function localos_exec_handler(a){logactivity("localos_exec_handler() called..."),console.log("an exec handler was called:  "),console.dir(a)}function localos_error_handler(a){if(logactivity("localos_error_handler() called..."),console.log("an error occurred on localos connector:  "),console.dir(a),"openfile"===a.cmd){var e={cmd:"appxmessage",args:[3,0],handler:"APPXRECEIVEFILE",data:null}
appx_session.ws.send(JSON.stringify(e))}}function localos_file_handler(a){appx_session.ws.send(JSON.stringify(a)),logactivity("localos_file_handler() called...")}/*********************************************************************
 **
 **   public/js/appx-client-remote.js - Client Remote conenction code
 **
 **   This module handles the connection and data traffic between the
 **   Appx Client running in the browser and the appx connector code
 **   running on the server.  The server connector is our proxy into
 **   the server Appx application.
 **
 *********************************************************************/
function APPX(e,a,t,s,n,r,o){function i(e,a,t,s,n,r){function o(){var e={cmd:"ping",args:[0,0],handler:"",data:null}
p.send(JSON.stringify(e)),c=setTimeout(o,3e4)}var p
null!=a&&null!=t?"ssl"==s?(ws_url="wss://"+a+":"+t+n,$("#appxFooterSSL").show(),$("#appxLoginSSL").show()):ws_url="ws://"+a+":"+t+n:ws_url="ws://localhost:3014/",p=new WebSocket(ws_url),p.send=function(e){var a=e
return appx_session.crypto&&(a=CryptoJS.AES.encrypt(e,"APPX",{format:JsonFormatter})),WebSocket.prototype.send.call(this,a)},p.onmessage=function(a){var t=a.data
appx_session.crypto&&(t=CryptoJS.AES.decrypt(a.data,"APPX",{format:JsonFormatter}).toString(CryptoJS.enc.Utf8)),e.handler(a,t)}
var c
return p.onopen=function(e){APPX.access=!0,appx_access=!0,o(),$("#appx_access").html("Remote+").css({color:"lime","font-weight":"bold"}),$("#functions").toggleClass("functions_on"),initialize_appx_session(r)},p.onclose=function(e){if(clearTimeout(c),APPX.access=!1,appx_access=!1,$("#appx_access").html("Remote").css({color:"#F77","font-weight":"bold"}),$("#functions").toggleClass("functions_on"),appx_session.connected){var a=$("<span>").html("Lost connection to server").addClass("status-msg").addClass("status-msg-error")
$("#appx-status-msg").html(a)}},p.onerror=function(o){console.log(o),l.connectRetryCount>0&&(l.connectRetryCount--,l.ws=i(e,a,t,s,n,r))},p}function p(){function e(e,a){debug&&logactivity("main handler: "+e)
try{var t=JSON.parse(a)
switch(t.serverConnectorVersionStr&&(appx_session.serverConnectorVersionStr=t.serverConnectorVersionStr,appx_session.serverConnectorVersionNum=t.serverConnectorVersionNum),t.mongoStatus&&("Error"!==t.mongoStatus||appx_session.mongoErrorDisplayed||(console.log(mongoConnectError),alert(appx_session.language.alerts.mongoConnectError),appx_session.mongoErrorDisplayed=!0)),appx_session.serverInterrupt=!1,t.type){case"HTML":$("#appx-frame").append(t.data)
break
case"STYLE":inject_style(t.data)
break
case"UPDATE":appxupdatelocalhandler(t.data)
break
case"SCRIPT":inject_script(t.data)
break
case"APPXLOGIN":appxloginhandler(t),appx_session.loginTimeout=!1
break
case"APPXRECONNECT":appxreconnecthandler(t)
break
case"APPXINIT":appxinithandler(t)
break
case"APPXFEATURES":appxfeatureshandler(t)
break
case"APPXEXTENDEDFEATURES":appxextendedfeatureshandler(t)
break
case"APPXPID":appxpidhandler(t)
break
case"APPXATTACH":appxattachhandler(t),$(document).on("keydown",function(e){sendkey(e)}),$(document).on("keyup",function(e){sendkey(e)})
break
case"APPXKEYMAP":appxkeymaphandler(t)
break
case"APPXITEMS":appxitemshandler(t)
break
case"APPXMSGS":appxmsgshandler(t)
break
case"APPXWIDGETS":appxwidgetshandler(t)
break
case"APPXSHOW":appxshowhandler(t)
break
case"APPXSCREEN":appx_session.blur=!1,appxscreenhandler(t)
break
case"APPXATTRIBUTES":appxattributeshandler(t)
break
case"APPXEXTRAATTRIBUTES":appxextraattributeshandler(t)
break
case"APPXPING":appxpinghandler(t)
break
case"APPXTOKEN":appxtokenhandler(t)
break
case"APPXRESOURCE":AppxResource.handler(t)
break
case"APPXSETFIELD":appxsetfieldhandler(t)
break
case"APPXLOADURL":appxloadurlhandler(t)
break
case"APPXRECEIVEFILE":appxreceivefilehandler(t)
break
case"APPXFILEUPLOADPROGRESS":appxfileuploadprogresshandler(t)
break
case"APPXSENDFILE":appxsendfilehandler(t)
break
case"APPXMENU":appxmenuhandler(t)
break
case"APPXCREATEOBJECT":appxobjectcreatehandler(t)
break
case"APPXINVOKEOBJECT":appxobjectinvokehandler(t)
break
case"APPXDESTROYOBJECT":appxobjectdestroyhandler(t)
break
case"APPXFINISH":appxfinishhandler(t)
break
case"APPXCNSTS":appxconstantshandler(t)
break
case"APPXGETCLIPBOARD":appxgetclipboardhandler(t)
break
case"APPXSETCLIPBOARD":appxsetclipboardhandler(t)
break
case"APPXTABLEDATA":appxtabledatahandler(t)
break
case"APPXQUERYTABLEDATA":appxupdatetabledatahandler(t)
break
case"APPXENCODINGERROR":appxEncodingError(t.data[1])
case"APPXPROCSTACK":appxProcessStack(t.data)
default:logactivity("No handler for APPX Data Message:  "+a)}}catch(s){logactivity(s),console.log("REMOTE Handler: "+s),console.log(s.stack)}}this.handler=e}var l=this
switch(this.connectRetryCount=2,this.message=new p,this.ws=i(this.message,e,a,n,s,o),this.appxDataCacheUrl=appxProtocol+"://"+appxConnectorHost+":"+appxConnectorMongoPort+appxConnectorPathHttp+"/getGridData",this.appxCacheUrl=appxProtocol+"://"+appxConnectorHost+":"+appxConnectorMongoPort+appxConnectorPathHttp,this.appxResourceUrl=appxProtocol+"://"+appxConnectorHost+":"+appxConnectorMongoPort+appxConnectorPathHttp+"/getResource/",this.current_msg={header:[]},this.uploadURL=null,this.userPrefsURL=null,this.init_optimization_flag=null,this.override=!1,this.blur=!1,this.current_show=null,this.clientIds={},this.editorConfigs={},this.widgets=[],this.appxTableList={},this.currenttabledata=[],this.items=[],this.rowtext=[],this.lineSeparator,this.basefontsize=r,this.rowHeightPx=21,this.colWidthPx=8,this.processhelp=!1,this.processhelpoption=null,this.runOnUnlock=[],this.scan=!1,this.screenrows=35,this.screencols=144,this.container_top=80,this.language={},this.image_cache={keys:[],length:0},this.token_cache={keys:[],length:0},this.token_groups={},this.showErrorDialog=null,this.pid=0,this.currsendfile={filename:"",filedata:[]},this.datacachepath="",this.loginTimeout=!0,this.serverConnectorVersionStr,this.serverConnectorVersionNum,this.localConnectorRunning=!1,this.localInstaller=null,this.mongoErrorDisplayed=!1,this.server=e,this.port=a,this.mongoPort=t,this.user=null,this.password=null,this.path=s,this.protocol=n,this.crypto="aes"==n,this.currentmenu=null,this.showoptnums=!1,this.createWidgetTag={},this.optionOverride={},this.globals={},this.gridcache={},this.gridpropscache={},this.dndData=[],this.connected=!1,this.interactT=null,this.interactTblur=null,this.topboxid=null,this.objFocus=null,this.objEventFired=!1,this.objItems=null,this.signaturePad,this.signaturePadID,this.signaturePadFail=!0,this.serverInterrupt=!1,this.activeDatepicker=null,this.locked=!1,this.keyLeft=null,this.msgs=[],this.dirtySinceSave=!1,this.tablist=null,this.lastOption,this.keyPauseLastPosition,this.rawEncoding,this.buildingEm=!1,this.config={debug:{tableLogging:!0}},this.rowCallback=!1,this.pendingResources={length:0},this.pendingTables=0,this.tableOptions,this.tableLoaded=!0,this.tablePreferences={},this.tableDefaults={},this.fileRecommendedUploadSize=parseInt($("meta[name=appx-recommended-upload-size]").attr("content")),this.fileCount=0,this.mongoFileUpload=[],this.mongoURL="",this.dropEvent=null,this.filesUploadArray=[],this.centerHorizontalOffset=76,this.centerVerticalOffset=0,this.valueTimer=null,this.valueTimerStart=function(e,a){if(appx_session.valueTimerStop(),e&&e!=OPT_NULL){var t=parseInt(appx_session.getProp("valueChangedTimer"))
t>0&&(logca("setting timeout"),appx_session.valueTimer=setTimeout(function(e){appx_session.valueTimer?(appx_session.valueTimerStop(),appx_session.keyPauseLastPosition=getCursorPosition(a),logca("keyPause: "+e),appxIsLocked()?logca("(locked"):appxwidgetcallback(e)):logca("keyPause was cancelled")},t,e))}},this.valueTimerStop=function(){appx_session.valueTimer&&(clearTimeout(appx_session.valueTimer),appx_session.valueTimer=null,logca("valueTimer stopped"))},this.globals.os=window.navigator.platform,this.globals.os){case"Win32":case"Win64":this.localInstaller="localConnector_win.exe",this.lineSeparator="\r \n"
break
case"MacIntel":this.localInstaller="localConnector_osx.dmg",this.lineSeparator="\n"
break
case"Linux x86_64":this.localInstaller="localConnector_linux64.sh",this.lineSeparator="\n"
break
case"Linux i686":this.localInstaller="localConnector_linux32.sh",this.lineSeparator="\n"
break
default:this.localInstaller="System Unknown",this.lineSeparator="\r \n"}var c=3621123835
mask0=(4278190080&c)>>24,mask1=(16711680&c)>>16,mask2=(65280&c)>>8,mask3=255&c,this.feature_mask=[parseInt(mask0),parseInt(mask1),parseInt(mask2),parseInt(mask3)]
var h=1787
exmask0=(4278190080&h)>>24,exmask1=(16711680&h)>>16,exmask2=(65280&h)>>8,exmask3=255&h,this.extended_feature_mask=[parseInt(exmask0),parseInt(exmask1),parseInt(exmask2),parseInt(exmask3)],$("<div id='appx_main_container_wrapper'>").addClass("appx_main_container_wrapper").append($("#appx_main_container")).appendTo("#main"),this.loginTimer=function(){setTimeout(function(){appx_session.loginTimeout&&(alert(appx_session.language.alerts.serverConnectError),location.reload())},1e4)}}function fetchQueryTableRowData(e,a,t,s){var n={cmd:"appxquerytabledata",args:[e,a],handler:"appxquerytabledata",data:null}
appx_session.ws.send(JSON.stringify(n))}function appxupdatetabledatahandler(e){updateGridMongo(e.data.rows,e.data.elid)}function appxProcessStack(e){for(var a in appx_session.gridpropscache){var t=!1
for(var s in e)a.indexOf(s)>-1&&(t=!0)
t||delete appx_session.gridpropscache[a]}}function fetchInitialTableRowData(e,a,t,s){var n={cmd:"appxtabledata",args:[e,a,t,s],handler:"appxtabledata",data:null}
appx_session.ws.send(JSON.stringify(n))}function appxtabledatahandler(e){var a=appx_session.currenttabledata[e.data.elid]
createGridMongo(a,e.data.rows,e.data.elid)}var cMsgCount=0,JsonFormatter={stringify:function(e){var a={ct:e.ciphertext.toString(CryptoJS.enc.Base64)}
return e.iv&&(a.iv=e.iv.toString()),e.salt&&(a.s=e.salt.toString()),JSON.stringify(a)},parse:function(e){var a=JSON.parse(e),t=CryptoJS.lib.CipherParams.create({ciphertext:CryptoJS.enc.Base64.parse(a.ct)})
return a.iv&&(t.iv=CryptoJS.enc.Hex.parse(a.iv)),a.s&&(t.salt=CryptoJS.enc.Hex.parse(a.s)),t}}
/*********************************************************************
 **
 **   public/js/appx-client-startup.js - Client entry point code
 **
 **   This module is the main entry point into the client.  It also
 **   has some initial startup helper code.
 **
 *********************************************************************/
function urlParam(o){var e=urlParamEx(window.location.href,o)
if(!e&&urlParamEx(window.location.href,"payload")){var a=4-urlParamEx(window.location.href,"payload")%4,t=""
a&&(t="===".substring(0,a)),e=urlParamEx(atob(urlParamEx(window.location.href,"payload").split("").reverse().join("").concat(t)),o)}return e}function urlParamEx(o,e){var a=new RegExp("[?&]"+e+"=([^&#]*)").exec(o)
return a?decodeURIComponent(a[1])||null:null}function checkLogin(){var o=parseQueryString()
"true"===$("meta[name=appx-allow-noLogin]").attr("content")&&(o.hasOwnProperty("requireLogin")&&$($("meta[name=appx-use-noLogin]")[0]).attr("content","false"===o.requireLogin),"true"!==$("meta[name=appx-use-noLogin]").attr("content")&&"false"!==o.requireLogin||(o.hasOwnProperty("user")&&$($("meta[name=appx-auto-user]")[0]).attr("content",o.user),o.hasOwnProperty("password")&&$($("meta[name=appx-auto-pswd]")[0]).attr("content",o.password),o.hasOwnProperty("host")&&$($("meta[name=appx-auto-host]")[0]).attr("content",o.host),o.hasOwnProperty("port")&&$($("meta[name=appx-auto-port]")[0]).attr("content",o.port),o.hasOwnProperty("specific")&&$($("meta[name=appx-use-specific]")[0]).attr("content",o.specific),o.hasOwnProperty("application")&&$($("meta[name=appx-application]")[0]).attr("content",o.application),o.hasOwnProperty("database")&&$($("meta[name=appx-database]")[0]).attr("content",o.database),o.hasOwnProperty("procType")&&$($("meta[name=appx-ProcType]")[0]).attr("content",o.procType),o.hasOwnProperty("process")&&$($("meta[name=appx-process]")[0]).attr("content",o.process),startSpecificProcess(!1)))}function adjustZoom(o){var e={transform:"scale("+o+")","-webkit-transform":"scale("+o+")","-moz-transform":"scale("+o+")","-moz-transform-origin":"left top"}
$("#appx_main_container_wrapper").css(e)}function zoomMax(){if(appx_session){null===appxOffsetTop&&getOriginalTop()
var o=$("#appx_main_container_wrapper").width()/(appx_session.colWidthPx*appx_session.screencols+18),e=appxOffsetTop/(appx_session.rowHeightPx*appx_session.screenrows)
appxZoom=Math.min(o,e),adjustZoom(appxZoom)}}function zoomAuto(){if(appxZoomAuto&&appx_session){null===appxOffsetTop&&getOriginalTop()
var o=$("#appx_main_container_wrapper").width()/(appx_session.colWidthPx*appx_session.screencols+18),e=appxOffsetTop/(appx_session.rowHeightPx*appx_session.screenrows)
appxZoom=Math.min(o,e),adjustZoom(appxZoom)}}function getVisibleOld(o){var e=$("#"+o),a=$(this).scrollTop(),t=a+$(this).height(),p=e.offset().top,n=p+e.outerHeight(),r=p<a?a:p,s=n>t?t:n
return s-r}function getVisible(o){var e=$("#"+o),a=e.offset().top,t=a+$("#status_bar").height(),p=$(window).height()
return p-t-a}function getOriginalTop(){appxOffsetTop=getVisible("appx_main_container_wrapper")}function closeSession(){"undefined"!==wss&&null!==wss&&wss.close(),ws&&ws.close(),appx_session.wss&&appx_session.wss.close(),appx_session.ws&&appx_session.ws.close()}function launchIntoFullscreen(o){o.requestFullscreen?o.requestFullscreen():o.mozRequestFullscreen?o.mozRequestFullscreen():o.webkitRequestFullscreen?o.webkitRequestFullscreen():o.msRequestFullscreen&&o.msRequestFullscreen()}function exitFullscreen(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullscreen?document.mozCancelFullscreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}function boxResize(){var o=$("#appx_main_container").width(),e=appx_session.centerHorizontalOffset
$("#appx_main_container").children().each(function(){var a=$(this).attr("id"),t=(o-$(this).width())/2
if(t<0&&(t=0),void 0!==a){var p=parseInt(a.substring(a.lastIndexOf("_")+1))
if((0===p||t<=appx_session.centerHorizontalOffset)&&appx_session.getProp("centerAppx")){var n=appx_session.centerHorizontalOffset
appx_session.centerHorizontalOffset=t
for(var r=0;r<p;r++){var s=$("#box_"+r)
if(s.length){var i=s.position().left-n
s.css({left:i+appx_session.centerHorizontalOffset+"px"})}}}var l=$(this).position().left,c=l-e+appx_session.centerHorizontalOffset
c<0&&(c=0)
if($(this).css({left:c+"px"}),1===p){var x=$("#box_0"),m=$(this)
x.children().length<=1&&x.position().top===m.position().top&&x.width===m.width&&x.height===m.height&&x.css({left:c+"px"})}}})}var appxLoginFormHost=$("meta[name=appx-login-host]").attr("content"),appxLoginFormPort=$("meta[name=appx-login-port]").attr("content"),appxLoginFormUser=$("meta[name=appx-login-user]").attr("content"),appxLoginFormPswd=$("meta[name=appx-login-pswd]").attr("content"),appxLoginFormRows=$("meta[name=appx-login-rows]").attr("content"),appxLoginFormCols=$("meta[name=appx-login-cols]").attr("content"),appxLoginFormHostHide="true"==$("meta[name=appx-login-host]").attr("hide"),appxLoginFormPortHide="true"==$("meta[name=appx-login-port]").attr("hide"),appxLoginFormUserHide="true"==$("meta[name=appx-login-user]").attr("hide"),appxLoginFormPswdHide="true"==$("meta[name=appx-login-pswd]").attr("hide"),appxLoginFormRowsHide="true"==$("meta[name=appx-login-rows]").attr("hide"),appxLoginFormColsHide="true"==$("meta[name=appx-login-cols]").attr("hide"),appxLoginFormMinified="min"==$("meta[name=appx-login-cols]").attr("content"),appxConnectorHost=$("meta[name=appx-proxy-host]").attr("content"),appxConnectorPort=$("meta[name=appx-proxy-port]").attr("content"),appxConnectorMongoPort=$("meta[name=appx-mongo-port]").attr("content"),appxConnectorPath=$("meta[name=appx-proxy-path]").attr("content"),appxConnectorPathHttp,appxProtocol
void 0===appxConnectorMongoPort&&(appxConnectorMongoPort=3015),appxConnectorPath.indexOf("wss")!=-1?(appxProtocol="https",appxConnectorPathHttp=appxConnectorPath.substring(0,appxConnectorPath.length-4)+appxProtocol):(appxProtocol="http",appxConnectorPathHttp=appxConnectorPath.substring(0,appxConnectorPath.length-3)+appxProtocol)
var appxClientRoot=$("meta[name=appx-client-root]").attr("content"),appxUseSoftkeys="true"==$("meta[name=appx-use-softkeys]").attr("content"),appxLoginAutoConnect="true"==$("meta[name=appx-auto-connect]").attr("content"),appxLocalRequired=$("meta[name=appx-local-required]").attr("content"),appxStaticTools=$("meta[name=appx-static-tools]").attr("content"),appxFillWindow=$("meta[name=appx-fill-window]").attr("content"),appxCloseOnExit=$("meta[name=appx-close-on-exit]").attr("content"),appxNewSession=!1,appxEncryption=$("meta[name=appx-encryption]").attr("content")
urlParam("acon")&&(appxLoginAutoConnect="true"==urlParam("acon"),appxLoginAutoConnect&&(appxCloseOnExit="back")),urlParam("localRequired")&&(appxLocalRequired="true"==urlParam("localRequired")),urlParam("user")&&(appxLoginFormUser=urlParam("user",appxLoginFormUser)),urlParam("port")&&(appxLoginFormPort=urlParam("port",appxLoginFormPort)),urlParam("host")&&(appxLoginFormHost=urlParam("host",appxLoginFormHost)),urlParam("rows")&&(appxLoginFormRows=urlParam("rows",appxLoginFormRows)),urlParam("cols")&&(appxLoginFormCols=urlParam("cols",appxLoginFormCols)),urlParam("pswd")&&(appxLoginFormPswd=urlParam("pswd")),appxLoginFormUser.length>0&&$("#appx_username").val(appxLoginFormUser),appxLoginFormPswd.length>0&&$("#appx_password").val(appxLoginFormPswd),appxLoginFormHost.length>0&&$("#appx_server").val(appxLoginFormHost),appxLoginFormPort.length>0&&$("#appx_port").val(appxLoginFormPort),appxLoginFormRows.length>0&&$("#appx_rows").val(appxLoginFormRows),appxLoginFormCols.length>0&&$("#appx_cols").val(appxLoginFormCols)
var focusElem=null
appxLoginFormColsHide?$("#appxLoginFormCols").attr("style","display: none;"):focusElem=$("#appx_cols"),appxLoginFormRowsHide?$("#appxLoginFormRows").attr("style","display: none;"):focusElem=$("#appx_rows"),appxLoginFormPortHide?$("#appxLoginFormPort").attr("style","display: none;"):focusElem=$("#appx_port"),appxLoginFormHostHide?$("#appxLoginFormHost").attr("style","display: none;"):focusElem=$("#appx_host"),appxLoginFormPswdHide?$("#appxLoginFormPswd").attr("style","display: none;"):focusElem=$("#appx_password"),appxLoginFormUserHide?$("#appxLoginFormUser").attr("style","display: none;"):focusElem=$("#appx_username"),focusElem&&focusElem.attr("autofocus","true")
var appxZoom=1,appxOffsetTop=null
$("#appx_zoom_in").click(function(){appxZoomAuto=!1,$("#appx_zoom_auto").css({color:"initial"}),appxZoom+=.1,adjustZoom(appxZoom),boxResize()}),$("#appx_zoom_out").click(function(){appxZoomAuto=!1,$("#appx_zoom_auto").css({color:"initial"}),appxZoom-=.1,adjustZoom(appxZoom),boxResize()}),$("#appx_zoom_dflt").click(function(){appxZoomAuto=!1,$("#appx_zoom_auto").css({color:"initial"}),appxZoom=1,adjustZoom(appxZoom),boxResize()}),$("#appx_zoom_max").click(function(){appxZoomAuto=!1,$("#appx_zoom_auto").css({color:"initial"}),zoomMax(),boxResize()}),$("#appx_zoom_full").click(function(){appxFullscreen?(appxFullscreen=!1,exitFullscreen()):(appxFullscreen=!0,launchIntoFullscreen(document.documentElement))}),$("#appx_zoom_auto").click(function(){appxZoomAuto?(appxZoomAuto=!1,appxZoom=appxZoomSave,$("#appx_zoom_auto").css({color:"initial"})):(appxZoomAuto=!0,appxZoomSave=appxZoom,$("#appx_zoom_auto").css({color:"red"})),zoomAuto(),adjustZoom(appxZoom),boxResize()})
var appxFullscreen=!1,appxZoomAuto=!1,appxZoomSave=1
$(window).on("scroll",zoomAuto),$(window).on("resize",function(){zoomAuto(),boxResize()})
var debug=!1,loggedin=!1,appxclientversion=[3,4],appxserverversion=null,client_init_sent=!1,appx_session,localos_session,localos_access=!1,appx_access=!1,xTriggered=0,optionTriggered=0,digits=[],basefontsize=14
$(document).ready(function(){debug?$("#log").show():$("#log").hide(),$(document.body).append($("<span>").attr("id","fontcheck").css({display:"none","font-family":"courier","font-size":"14px",padding:"0px",margin:"0px","box-sizing":"border-box"}).text("XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX")),$("#fontcheck").width()>800&&(basefontsize=14*(1-($("#fontcheck").width()-800)/$("#fontcheck").width())),$("#fontcheck").remove()
var o="MozWebSocket"in window?"MozWebSocket":"WebSocket"in window?"WebSocket":null
if(null!=o)if(appendMessage("WebSockets --  are fully supported in this browser."),localStorage.newsession){appxNewSession=!0
var e=JSON.parse(localStorage.newsession)
delete localStorage.newsession,appx_session=new APPX(appxConnectorHost,appxConnectorPort,appxConnectorMongoPort,appxConnectorPath,appxEncryption,basefontsize,appxLoginFormMinified),appx_session.startupinfo=e,setTimeout(function(){sendappxnewsessionlogin(e.remoteHost,e.remotePort,e.remoteUser,e.remotePassword,e)},1500)}else appx_session=new APPX(appxConnectorHost,appxConnectorPort,appxConnectorMongoPort,appxConnectorPath,appxEncryption,basefontsize,appxLoginFormMinified)
else appendMessage(webSocketError)
$("#localos_access").removeClass().html("<a href='"+appxClientRoot+"/"+appx_session.localInstaller+"'>Local</a>"),loadLanguage(),void 0==appxClientRoot&&alert(appx_session.language.alerts.rootError)}),$(function(){window.onbeforeunload=function(o){if(appx_session.connected)return o.returnValue="This will end your Appx session!","This will end your Appx session!"},window.onunload=function(o){appx_session.connected&&appxwidgetcallback(356),closeSession()},console.log("%cYou should only be here under the direction of APPX Technical Support. Please contact your System Administrator if this is not the case.","background-color: black; color: yellow; font-size: large")})
