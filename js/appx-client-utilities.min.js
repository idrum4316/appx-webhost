/*********************************************************************
 **
 **   public/js/appx-client-utilities.js - Client helper functions
 **
 **   This module contains some helper functions used by the client
 **
 *********************************************************************/
function initialize_localos_session(){var e={cmd:"localosinit",args:[0,0],handler:"localos_init_handler",data:{languageId:appx_session.language.id},authToken:localStorage.authToken}
localos_session.ws.send(JSON.stringify(e))}function initialize_appx_session(e){var o={cmd:"appxinit",args:[e,0],handler:"appx_init_handler",data:null}
appx_session.ws.send(JSON.stringify(o))}function appendMessage(e){debug&&$("#log").prepend(e+"\n\n")}function initialize_localos_directories(e){var o={cmd:"localoscreatedir",args:[e,0],handler:"localos_init_handler",data:null,authToken:localStorage.authToken}
localos_session.ws.send(JSON.stringify(o))}function inject_image(e){var o=window.URL.createObjectURL(new Blob(e))
img=new Image,img.src=o,$("body").prepend(img)}function inject_image2(e){var o=window.URL.createObjectURL(new Blob([toArrayBuffer(e)]))
img=new Image,img.src=o,$("body").prepend(img)}function inject_script(e){var o=document.createElement("script")
o.type="text/javascript",o.text=e,document.head.appendChild(o)}function inject_style(e){$("head").append($("<style>").attr("type","text/css").text(e)),$("body").change()}function logactivity(e){debug&&console.log(e)}function logca(e){debug&&console.log(++testca+"\t"+e)}function toArrayBuffer(e){for(var o=new ArrayBuffer(e.length),n=new Uint8Array(o),s=0;s<e.length;++s)n[s]=e[s]
return o}function localos_enviro_handler(e){if(logactivity("localos_enviro_handler() called..."),appx_session.setProp("clientPublicVersionStr",appxPublicClientVersionStr),appx_session.setProp("clientPublicVersionNum",appxPublicClientVersionNum),e.localConnectorVersionStr?appx_session.setProp("localConnectorVersionStr",e.localConnectorVersionStr):appx_session.setProp("localConnectorVersionStr","Unknown"),e.localConnectorVersionNum?appx_session.setProp("localConnectorVersionNum",e.localConnectorVersionNum):appx_session.setProp("localConnectorVersionNum",99999.999),appx_session.local_environment=e,appx_session.getProp("localConnectorVersionNum")>=60000.19022101&&!appx_session.local_environment.authTokenValid){var o=Math.floor(1e5+9e5*Math.random())
localos_session.ws.send(JSON.stringify({cmd:"auth",args:[],handler:"",data:{appName:$("meta[name=appx-app-name]").attr("content"),accessCode:o}})),$("#appx-status-msg").html("<span class='status-msg-error'>&nbsp;Local Connector Access Code: "+o+"&nbsp;</span>")}try{setTimeout(function(){if(appx_session.userhome=e[appx_session.globals.os.indexOf("Win")>-1?"USERPROFILE":"HOME"],appx_session.setProp("userHome",appx_session.userhome),$("#localos_access").prop("title",appx_session.language.tooltips.localVersion+appx_session.getProp("localConnectorVersionStr")),appx_session.getProp("localConnectorVersionNum")<appxServerClientVersionNum&&($("#localos_access").html("Local-").css({color:"#FF7","font-weight":"bold"}),appx_session.getProp("localConnectorVersionNum")>50402.009&&null==localos_session.isUpdating)){var o={cmd:"updatelocal",args:[],handler:"appx_updatelocal_handler",data:null}
appx_session.ws.send(JSON.stringify(o))}},1e3)}catch(n){console.log("localos_enviro_handler: can't set home - "+n),console.log(n.stack)}}function appxupdatelocalhandler(e){if(appxIsLocalReady()){var o={}
o.filename="localConnectorUpdate.zip",o.filedata=e,ms={cmd:"update",args:[o],handler:"localos_update_handler",data:null,authToken:localStorage.authToken},$("#localos_access").html("Updating").css({color:"#F77","font-weight":"bold"}),localos_session.isUpdating=!0,localos_session.ws.send(JSON.stringify(ms))}}function parseQueryString(){for(var e={},o=[],n=window.location.href.substring(window.location.href.indexOf("?")+1).split("&"),s=0;s<n.length;s++)o=n[s].split("="),e[decodeURI(o[0])]=decodeURI(o[1])
return e}var appxPublicClientVersionStr="6.0.0.20072712",appxPublicClientVersionNum=60000.20072712,testca=0
